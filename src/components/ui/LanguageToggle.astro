---
import { getLangFromUrl } from "@/i18n/utils";

interface Props {
  class?: string;
}

const { class: className } = Astro.props;
const lang = getLangFromUrl(Astro.url);

const currentPath = Astro.url.pathname;
let targetPath = "";

if (lang === "es") {
  targetPath = currentPath.replace(/^\/es/, "/en");
} else {
  targetPath = currentPath.replace(/^\/en/, "/es");
}
---

<a
  href={targetPath}
  class:list={[
    "relative flex cursor-pointer items-center justify-center rounded-full transition-colors select-none hover:bg-black/5 dark:hover:bg-white/5",
    className,
  ]}
  aria-label="Change language"
>
  <span
    class:list={[
      "absolute inset-0 flex items-center justify-center transition-all duration-500 ease-in-out",
      lang === "es"
        ? "scale-100 rotate-0 opacity-100"
        : "scale-0 rotate-90 opacity-0",
    ]}
  >
    <svg
      class="h-full w-full p-0.5"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2.5"
      stroke-linecap="round"
      stroke-linejoin="round"
    >
      <text
        x="50%"
        y="54%"
        dominant-baseline="middle"
        text-anchor="middle"
        font-size="10"
        font-weight="bold"
        fill="currentColor"
        stroke="none">ES</text
      >
    </svg>
  </span>

  <span
    class:list={[
      "absolute inset-0 flex items-center justify-center transition-all duration-350 ease-in-out",
      lang === "en"
        ? "scale-100 rotate-0 opacity-100"
        : "scale-0 -rotate-90 opacity-0",
    ]}
  >
    <svg
      class="h-full w-full p-0.5"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2.5"
      stroke-linecap="round"
      stroke-linejoin="round"
    >
      <text
        x="50%"
        y="54%"
        dominant-baseline="middle"
        text-anchor="middle"
        font-size="10"
        font-weight="bold"
        fill="currentColor"
        stroke="none">EN</text
      >
    </svg>
  </span>
</a>
